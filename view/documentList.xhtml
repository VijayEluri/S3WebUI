<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:a="http://richfaces.org/a4j"
                template="layout/template.xhtml">

    <ui:define name="body">
        <a:outputPanel  id="main" >
            <h:form>
        <rich:panel>
            <f:facet name="header">
                <h2>#{documentListAction.defaultRepository.name}</h2>

            </f:facet>
            <h:outputLabel id="path" rendered="#{documentListAction.hasLevelAbove}">
                Displaying Folder: #{documentListAction.currentFolder.key} &nbsp;&nbsp;
            </h:outputLabel>
            <a:commandButton image="/img/upLevel.png" id="goUp"
                                            rendered="#{documentListAction.hasLevelAbove}"
                                            action="#{documentListAction.goUpLevel()}" reRender="main" />
                        
            <rich:dataTable id="itemsTable" value="#{displayItems}"  border="0"
                         var="item" rendered="#{displayItems != null and displayItems.size > 0 }">
                <rich:column id="column1">
                    <f:facet id="NameFacet" name="header">Name</f:facet>
                    <h:graphicImage value="#{item.iconFile}" alt="#{item.name}"/>
                    <a:commandLink id="open" value="#{item.name}"
                            action="#{documentListAction.openItem(item)}" reRender="main" immediate="true" />
                </rich:column>
                <rich:column id="column6">
                    <f:facet id="publicurl" name="header">Public URL</f:facet>
                    #{item.publicUrl}
                </rich:column>
                <rich:column id="column11">
                    <f:facet id="PasswordFacet" name="header">Password</f:facet>
                    #{item.password}
                </rich:column>
                <rich:column id="column5">
                    <f:facet id="ActionFacet" name="header">Action</f:facet>
                    <a:commandLink id="delete" value="Delete" action="#{documentListAction.delete(item)}"
                            rendered="#{item.deletable}" reRender="main" immediate="true"/>
                </rich:column>
            </rich:dataTable>
        </rich:panel>
            </h:form>
    </a:outputPanel>
        <rich:panel>
            <f:facet name="header">Upload new file</f:facet>
            <h:form id="uploadForm" enctype="multipart/form-data">
                <s:validateAll>
                    <fieldset>
                        <legend>Enter file to upload</legend>
                        <div>
                            <s:fileUpload id="newFile"
                                          data="#{documentUploadAction.data}" accept="image/*"
                                          contentType="#{documentUploadAction.contentType}"
                                          fileName="#{documentUploadAction.name}"
                                          size="80" maxlength="80" required="true"/>
                        </div>
                        <div>
                            <br />
                            <h:selectOneMenu value="#{documentUploadAction.securityMode}">
                                <s:selectItems var="mode" value="#{securityModes}"
                                               label="#{mode.longName}" noSelectionLabel="-- Select Security Mode--"/>
                                <s:convertEnum/>
                            </h:selectOneMenu>
                            <h:outputLabel for="password"> &nbsp;&nbsp;Password:</h:outputLabel>
                            <h:inputText id="password" value="#{documentUploadAction.password}"/>

                        </div>

                        <div>
                            <h:commandButton value="Upload"
                                             action="#{documentUploadAction.upload}"
                                             reRender="itemsPanel" id="uploadButton"/>
                        </div>
                    </fieldset>
                </s:validateAll>
            </h:form>
        </rich:panel>
        <rich:panel>
            <f:facet name="header">Create new folder here</f:facet>
            <h:form id="newFolderForm">
                <s:validateAll>

                    <div>

                        <h:outputLabel for="folderName">Folder Name:</h:outputLabel>
                        <h:inputText id="folderName" value="#{newFolderAction.name}"/>
                        <br />
                        <span>&nbsp;&nbsp;</span>
                        <h:selectOneMenu value="#{newFolderAction.securityMode}">
                                <s:selectItems var="mode" value="#{securityModes}"
                                               label="#{mode.longName}" noSelectionLabel="-- Select Security Mode--"/>
                                <s:convertEnum/>
                            </h:selectOneMenu>

                         <h:outputLabel for="password"> &nbsp;&nbsp;Password:</h:outputLabel>
                            <h:inputText id="password" value="#{newFolderAction.password}"/>
                        <a:commandButton value="create"
                                         action="#{newFolderAction.create()}"
                                         reRender="main" id="newFolderButton"/>
                    </div>
                </s:validateAll>
            </h:form>
        </rich:panel>
    </ui:define>
</ui:composition>
